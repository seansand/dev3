
String text = '''
<nflSchedule week="9">
  <matchup kickoff="1351815600" gameSecondsRemaining="0">
    <team id="KCC" isHome="0" score="13" rushDefenseRank="23" passDefenseRank="11" rushOffenseRank="4" passOffenseRank="25" hasPossession="0" inRedZone="0" />
    <team id="SDC" isHome="1" score="31" rushDefenseRank="4" passDefenseRank="18" rushOffenseRank="19" passOffenseRank="21" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352052000" gameSecondsRemaining="3600">
    <team id="MIA" isHome="0" score="" rushDefenseRank="11" passDefenseRank="17" rushOffenseRank="21" passOffenseRank="23" hasPossession="0" inRedZone="0" />
    <team id="IND" isHome="1" score="" rushDefenseRank="16" passDefenseRank="29" rushOffenseRank="24" passOffenseRank="7" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352052000" gameSecondsRemaining="3600">
    <team id="DEN" isHome="0" score="" rushDefenseRank="7" passDefenseRank="10" rushOffenseRank="17" passOffenseRank="18" hasPossession="0" inRedZone="0" />
    <team id="CIN" isHome="1" score="" rushDefenseRank="19" passDefenseRank="27" rushOffenseRank="9" passOffenseRank="25" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352052000" gameSecondsRemaining="3600">
    <team id="BAL" isHome="0" score="" rushDefenseRank="21" passDefenseRank="7" rushOffenseRank="11" passOffenseRank="5" hasPossession="0" inRedZone="0" />
    <team id="CLE" isHome="1" score="" rushDefenseRank="24" passDefenseRank="26" rushOffenseRank="16" passOffenseRank="31" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352052000" gameSecondsRemaining="3600">
    <team id="CHI" isHome="0" score="" rushDefenseRank="6" passDefenseRank="25" rushOffenseRank="14" passOffenseRank="3" hasPossession="0" inRedZone="0" />
    <team id="TEN" isHome="1" score="" rushDefenseRank="27" passDefenseRank="13" rushOffenseRank="28" passOffenseRank="14" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352052000" gameSecondsRemaining="3600">
    <team id="DET" isHome="0" score="" rushDefenseRank="8" passDefenseRank="4" rushOffenseRank="19" passOffenseRank="1" hasPossession="0" inRedZone="0" />
    <team id="JAC" isHome="1" score="" rushDefenseRank="20" passDefenseRank="19" rushOffenseRank="15" passOffenseRank="16" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352052000" gameSecondsRemaining="3600">
    <team id="CAR" isHome="0" score="" rushDefenseRank="22" passDefenseRank="2" rushOffenseRank="29" passOffenseRank="9" hasPossession="0" inRedZone="0" />
    <team id="WAS" isHome="1" score="" rushDefenseRank="3" passDefenseRank="30" rushOffenseRank="4" passOffenseRank="4" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352052000" gameSecondsRemaining="3600">
    <team id="ARI" isHome="0" score="" rushDefenseRank="17" passDefenseRank="3" rushOffenseRank="26" passOffenseRank="21" hasPossession="0" inRedZone="0" />
    <team id="GBP" isHome="1" score="" rushDefenseRank="28" passDefenseRank="6" rushOffenseRank="25" passOffenseRank="11" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352052000" gameSecondsRemaining="3600">
    <team id="BUF" isHome="0" score="" rushDefenseRank="18" passDefenseRank="19" rushOffenseRank="1" passOffenseRank="24" hasPossession="0" inRedZone="0" />
    <team id="HOU" isHome="1" score="" rushDefenseRank="9" passDefenseRank="9" rushOffenseRank="19" passOffenseRank="15" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352063100" gameSecondsRemaining="3600">
    <team id="TBB" isHome="0" score="" rushDefenseRank="1" passDefenseRank="23" rushOffenseRank="8" passOffenseRank="30" hasPossession="0" inRedZone="0" />
    <team id="OAK" isHome="1" score="" rushDefenseRank="3" passDefenseRank="12" rushOffenseRank="25" passOffenseRank="12" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352063100" gameSecondsRemaining="3600">
    <team id="MIN" isHome="0" score="" rushDefenseRank="15" passDefenseRank="16" rushOffenseRank="10" passOffenseRank="13" hasPossession="0" inRedZone="0" />
    <team id="SEA" isHome="1" score="" rushDefenseRank="4" passDefenseRank="11" rushOffenseRank="13" passOffenseRank="29" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352064300" gameSecondsRemaining="3600">
    <team id="PIT" isHome="0" score="" rushDefenseRank="13" passDefenseRank="14" rushOffenseRank="23" passOffenseRank="22" hasPossession="0" inRedZone="0" />
    <team id="NYG" isHome="1" score="" rushDefenseRank="23" passDefenseRank="22" rushOffenseRank="20" passOffenseRank="27" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352078400" gameSecondsRemaining="3600">
    <team id="DAL" isHome="0" score="" rushDefenseRank="10" passDefenseRank="5" rushOffenseRank="7" passOffenseRank="10" hasPossession="0" inRedZone="0" />
    <team id="ATL" isHome="1" score="" rushDefenseRank="25" passDefenseRank="15" rushOffenseRank="18" passOffenseRank="8" hasPossession="0" inRedZone="0" />
  </matchup>
  <matchup kickoff="1352165400" gameSecondsRemaining="3600">
    <team id="PHI" isHome="0" score="" rushDefenseRank="14" passDefenseRank="1" rushOffenseRank="6" passOffenseRank="6" hasPossession="0" inRedZone="0" />
    <team id="NOS" isHome="1" score="" rushDefenseRank="26" passDefenseRank="28" rushOffenseRank="27" passOffenseRank="2" hasPossession="0" inRedZone="0" />
  </matchup>
</nflSchedule>

'''



println convertXmlToJson(text)


Integer normalizeScore(String text)
{
   if (text.trim() == "")
      return 0;
   else return Integer.parseInt(text)
}

String normalizeId(String team)
{
   team = team.toUpperCase().trim();
   switch (team)
   {
      case "JAX": team = "JAC"; break;
      case "KCC": team = "KC"; break;
      case "NOS": team = "NO"; break;
      case "GBP": team = "GB"; break;
      case "SFO": team = "SF"; break;
      case "TBB": team = "TB"; break;
      case "NEP": team = "NE"; break;
      case "SDC": team = "SD"; break;
      case "ARZ": team = "ARI"; break;
      case "AZ":  team = "ARI"; break;
      default:  throw new RuntimeException("Unknown team $team"); break;
   }
   return team;

}


String convertXmlToJson(String text)
{
   def mapOfMaps = new LinkedHashMap<String, LinkedHashMap<String, Object>>();
   
   def nflSchedule = new XmlSlurper().parseText(text)
   
   println nflSchedule.matchup.size()
   
   nflSchedule.matchup.each()
   {
      m ->
      
      println m.@gameSecondsRemaining
      
      Map prevMap = null;
      String prevOpp = ""
      String prevScore =""
      
      m.team.each()
      {
          String teamId = normalizeId(it.@id)
          Integer teamScore = normalizeScore(it.@score)
          Integer secsRemaining = normalizeScore(m.@gameSecondsRemaining)       
          
          println teamScore
          Map attrs = [:]
          mapOfMaps.put(teamId, attrs)
          attrs.put("score", teamScore)
          attrs.put("remaining", )
          
          if (prevMap == null)
          {
             prevMap = attrs;
             prevScore = teamScore
             prevOpp = teamId
          }
          else
          {
             attrs.put("oppScore", prevScore)
             attrs.put("opp", prevOpp)
             prevMap.put("oppScore", teamScore)
             prevMap.put("opp", teamId)       
             prevMap = null;
          }
      }
   }
   
   return mapOfMaps
}




